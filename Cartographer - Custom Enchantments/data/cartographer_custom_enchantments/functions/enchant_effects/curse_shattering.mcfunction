execute store result score @s[type=item] ca.cur_dmg run data get entity @s Item.tag.Damage
execute store result score @s[type=item] ca.dmg_to_deal run data get entity @s Item.tag.Damage

execute as @s[type=item,nbt={Item:{id:"minecraft:turtle_helmet",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 275

execute as @s[type=item,nbt={Item:{id:"minecraft:elytra",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 432

execute as @s[type=item,nbt={Item:{id:"minecraft:leather_helmet",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 55
execute as @s[type=item,nbt={Item:{id:"minecraft:leather_chestplate",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 80
execute as @s[type=item,nbt={Item:{id:"minecraft:leather_leggings",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 75
execute as @s[type=item,nbt={Item:{id:"minecraft:leather_boots",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 65

execute as @s[type=item,nbt={Item:{id:"minecraft:golden_helmet",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 77
execute as @s[type=item,nbt={Item:{id:"minecraft:golden_chestplate",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 112
execute as @s[type=item,nbt={Item:{id:"minecraft:golden_leggings",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 105
execute as @s[type=item,nbt={Item:{id:"minecraft:golden_boots",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 91

execute as @s[type=item,nbt={Item:{id:"minecraft:chainmail_helmet",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 165
execute as @s[type=item,nbt={Item:{id:"minecraft:chainmail_chestplate",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 240
execute as @s[type=item,nbt={Item:{id:"minecraft:chainmail_leggings",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 225
execute as @s[type=item,nbt={Item:{id:"minecraft:chainmail_boots",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 195

execute as @s[type=item,nbt={Item:{id:"minecraft:iron_helmet",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 165
execute as @s[type=item,nbt={Item:{id:"minecraft:iron_chestplate",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 240
execute as @s[type=item,nbt={Item:{id:"minecraft:iron_leggings",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 225
execute as @s[type=item,nbt={Item:{id:"minecraft:iron_boots",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 195

execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_helmet",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 363
execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_chestplate",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 528
execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_leggings",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 495
execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_boots",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 429

execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_helmet",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 407
execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_chestplate",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 592
execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_leggings",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 555
execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_boots",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 481

execute as @s[type=item,nbt={Item:{id:"minecraft:wooden_axe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 59
execute as @s[type=item,nbt={Item:{id:"minecraft:wooden_hoe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 59
execute as @s[type=item,nbt={Item:{id:"minecraft:wooden_pickaxe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 59
execute as @s[type=item,nbt={Item:{id:"minecraft:wooden_shovel",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 59
execute as @s[type=item,nbt={Item:{id:"minecraft:wooden_sword",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 59

execute as @s[type=item,nbt={Item:{id:"minecraft:stone_axe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 131
execute as @s[type=item,nbt={Item:{id:"minecraft:stone_hoe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 131
execute as @s[type=item,nbt={Item:{id:"minecraft:stone_pickaxe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 131
execute as @s[type=item,nbt={Item:{id:"minecraft:stone_shovel",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 131
execute as @s[type=item,nbt={Item:{id:"minecraft:stone_sword",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 131

execute as @s[type=item,nbt={Item:{id:"minecraft:golden_axe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 32
execute as @s[type=item,nbt={Item:{id:"minecraft:golden_hoe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 32
execute as @s[type=item,nbt={Item:{id:"minecraft:golden_pickaxe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 32
execute as @s[type=item,nbt={Item:{id:"minecraft:golden_shovel",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 32
execute as @s[type=item,nbt={Item:{id:"minecraft:golden_sword",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 32

execute as @s[type=item,nbt={Item:{id:"minecraft:iron_axe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 250
execute as @s[type=item,nbt={Item:{id:"minecraft:iron_hoe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 250
execute as @s[type=item,nbt={Item:{id:"minecraft:iron_pickaxe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 250
execute as @s[type=item,nbt={Item:{id:"minecraft:iron_shovel",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 250
execute as @s[type=item,nbt={Item:{id:"minecraft:iron_sword",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 250

execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_axe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 1561
execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_hoe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 1561
execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_pickaxe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 1561
execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_shovel",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 1561
execute as @s[type=item,nbt={Item:{id:"minecraft:diamond_sword",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 1561

execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_axe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 2031
execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_hoe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 2031
execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_pickaxe",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 2031
execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_shovel",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 2031
execute as @s[type=item,nbt={Item:{id:"minecraft:netherite_sword",tag:{CustomEnchantments:[{id:"curse_shattering"}]}}}] run scoreboard players set @s ca.max_dmg 2031

scoreboard players operation @s ca.dmg_to_deal = @s ca.max_dmg
scoreboard players operation @s ca.dmg_to_deal -= @s ca.cur_dmg

scoreboard players operation @s ca.dmg_to_deal /= $2 ca.CONSTANT

#scoreboard players operation @s ca.dmg_to_deal += @s ca.cur_dmg

execute store result entity @s Item.tag.Damage int 1 run scoreboard players operation @s ca.dmg_to_deal += @s ca.cur_dmg